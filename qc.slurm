#!/bin/bash
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=8
#SBATCH --mem=85000
#SBATCH --time=10:00:00
#SBATCH --job-name=qc
#SBATCH --partition=batch
#SBATCH --error=/work/biocore/zalsafwani/CRC_data/raw_reads/qc/script_output/err.out
#SBATCH --output=/work/biocore/zalsafwani/CRC_data/raw_reads/qc/script_output/std.out
#SBATCH --open-mode=append


############################################
# Run fastQC for multiple samples
############################################


module load fastqc/0.11

cd /work/biocore/zalsafwani/CRC_data/raw_reads

declare -a sample_name=(SRR15018640 SRR15018641 SRR15018642 SRR15018643 SRR15018644 
    SRR15018645 SRR15018646 SRR15018647 SRR15018648 SRR15018649 SRR15018650 
    SRR15018651 SRR15018652 SRR15018653 SRR15018654 SRR15018655 SRR15018656 
    SRR15018657 SRR15018658 SRR15018659 SRR15018660 SRR15018661 SRR15018662 
    SRR15018663 SRR15018664 SRR15018665 SRR15018666 SRR15018667 SRR15018668 
    SRR15018669 SRR15018670 SRR15018671 SRR15018672 SRR15018673 SRR15018674 
    SRR15018675 SRR15018676 SRR15018677 SRR15018678 SRR15018679 SRR15018680 
    SRR15018681 SRR15018682 SRR15018683 SRR15018684 SRR15018685 SRR15018686 
    SRR15018687 SRR15018688 SRR15018689 SRR15018690 SRR15018691 SRR15018692 
    SRR15018693 SRR15018694 SRR15018695 SRR15018696 SRR15018697 SRR15018698 
    SRR15018699 SRR15018700 SRR15018701 SRR15018702 SRR15018703 SRR15018704 
    SRR15018705 SRR15018706 SRR15018707 SRR15018708 SRR15018709 SRR15018710 
    SRR15018711 SRR15018712 SRR15018713 SRR15018714 SRR15018715 SRR15018716 
    SRR15018717 SRR15018718 SRR15018719 SRR15018720 SRR15018721 SRR15018722 
    SRR15018723 SRR15018724 SRR15018725 SRR15018726 SRR15018727 SRR15018728 
    SRR15018729 SRR15018730 SRR15018731 SRR15018732 SRR15018733 SRR15018734 
    SRR15018735 SRR15018736 SRR15018737 SRR15018738 SRR15018739 SRR15018740 SRR15018741)

echo "Started QC"
for i in ${sample_name[@]}; do
	fastqc $i"_1.fastq" -o qc/
	fastqc $i"_2.fastq" -o qc/
done
echo "Finishied QC"


############################################
# Run multiqc for all fastQC results
############################################

# Run multiqc in order to look at the QC of the data in one report. 
cd qc
module load multiqc/py37/1.8
mkdir multiqc
echo "Started multiqc"
multiqc *_fastqc.zip -o multiqc/
echo "Finishied multiqc"
